# üç™ Instagram Cookie Fayllarini Qo'shish - Aniq Yo'riqnoma

## üìã Qadam 1: Birinchi Cookie Faylini Qo'shish

### 1.1. Cookie faylini yuklab olish

**Variant A: Browser Extension orqali (Eng oson)**

1. Chrome/Firefox'ga **EditThisCookie** yoki **Cookie-Editor** extension'ni o'rnating
2. Instagram.com'ga kirib, login qiling
3. Extension'ni oching va **Export** tugmasini bosing
4. **Netscape HTTP Cookie File** formatini tanlang
5. Cookie'larni ko'chirib oling

**Variant B: Browser DevTools orqali**

1. Instagram.com'ga kirib, login qiling
2. `F12` bosing (Developer Tools)
3. **Application** tab ‚Üí **Cookies** ‚Üí `https://www.instagram.com`
4. Quyidagi cookie'larni toping va qiymatlarini ko'chirib oling:
   - `sessionid`
   - `csrftoken`
   - `ds_user_id`

### 1.2. Cookie faylini yaratish

Server'da quyidagi buyruqni bajaring:

```bash
cd ~/www/download.e-qarz.uz
mkdir -p storage/app/cookies
nano storage/app/cookies/instagram_cookies.txt
```

### 1.3. Cookie faylini to'ldirish

**Agar Export qilgan bo'lsangiz:**
- Export qilingan matnni to'liq ko'chirib, faylga yozing

**Agar manual yozmoqchi bo'lsangiz:**

Quyidagi formatda yozing (Netscape format):

```
# Netscape HTTP Cookie File
# This file was generated by EditThisCookie
# EditThisCookie is a browser extension for editing cookies

.instagram.com	TRUE	/	FALSE	1735689600	sessionid	YOUR_SESSIONID_VALUE
.instagram.com	TRUE	/	FALSE	1735689600	csrftoken	YOUR_CSRFTOKEN_VALUE
.instagram.com	TRUE	/	FALSE	1735689600	ds_user_id	YOUR_DS_USER_ID_VALUE
```

**Muhim:**
- `YOUR_SESSIONID_VALUE` o'rniga haqiqiy `sessionid` qiymatini yozing
- `YOUR_CSRFTOKEN_VALUE` o'rniga haqiqiy `csrftoken` qiymatini yozing
- `YOUR_DS_USER_ID_VALUE` o'rniga haqiqiy `ds_user_id` qiymatini yozing
- `1735689600` - bu cookie amal qilish muddati (Unix timestamp). Kattaroq raqam yozing (masalan, 2000000000)

**Faylni saqlash:**
- `Ctrl+O` (saqlash)
- `Enter` (tasdiqlash)
- `Ctrl+X` (chiqish)

---

## üìã Qadam 2: Ikkinchi Cookie Faylini Qo'shish (Tavsiya etiladi)

### 2.1. Ikkinchi Instagram account'dan cookie olish

**Eng yaxshi variant:** Boshqa Instagram account'dan cookie oling

1. Boshqa Instagram account'ga kirib, login qiling
2. Yuqoridagi usul bilan cookie'larni export qiling
3. Yangi fayl yarating:

```bash
nano storage/app/cookies/instagram_cookies2.txt
```

4. Export qilingan cookie'larni bu faylga yozing va saqlang

**Agar boshqa account bo'lmasa:**
- Birinchi account'dan yangi cookie export qiling (cookie'lar eskirgan bo'lishi mumkin)
- Yoki birinchi cookie'ni ko'chirib, `instagram_cookies2.txt` nomi bilan saqlang

---

## üìã Qadam 3: Cookie Fayllarini Tekshirish

```bash
cd ~/www/download.e-qarz.uz

# Cookie fayllarini ko'rish
ls -lh storage/app/cookies/

# Cookie fayllarining hajmini tekshirish (kamida 100 bytes bo'lishi kerak)
du -h storage/app/cookies/*.txt

# Cookie fayllarida sessionid borligini tekshirish
grep -l "sessionid" storage/app/cookies/*.txt
```

**Natija:**
- Agar `instagram_cookies.txt` va `instagram_cookies2.txt` ko'rinsa - ‚úÖ
- Agar `sessionid` topilsa - ‚úÖ

---

## üìã Qadam 4: Scriptni Ishga Tushirish

```bash
cd ~/www/download.e-qarz.uz

# Scriptga execute permission bering
chmod +x SETUP_MULTIPLE_COOKIES.sh
chmod +x FIX_INSTAGRAM_IMAGE_MULTIPLE_COOKIES.sh

# Cookie fayllarini sozlash
./SETUP_MULTIPLE_COOKIES.sh
```

**Script quyidagilarni qiladi:**
1. ‚úÖ Cookie fayllarini tekshiradi
2. ‚úÖ `.env` faylini yangilaydi
3. ‚úÖ Config'ni yangilaydi
4. ‚úÖ Workerlarni qayta ishga tushiradi

---

## üìã Qadam 5: Test Qilish

### 5.1. Loglarni kuzatish

```bash
# Yangi terminal o'chib, loglarni kuzatib turing
tail -f storage/logs/laravel.log | grep -E 'cookie|Instagram image'
```

### 5.2. Botga test link yuborish

1. Botga Instagram rasm linki yuboring:
   ```
   https://www.instagram.com/p/DThRA3DDLSd/
   ```

2. Loglarda quyidagilarni ko'rasiz:
   ```
   Trying Instagram image download with cookie file
   cookie_index: 1
   cookie_path: instagram_cookies.txt
   ```

3. Agar birinchi cookie ishlamasa:
   ```
   Instagram image download with cookie failed, trying next
   cookie_index: 2
   cookie_path: instagram_cookies2.txt
   ```

---

## üîß Muammo Bo'lsa

### Cookie fayli to'g'ri formatda emas

```bash
# Cookie faylini tekshirish
head -5 storage/app/cookies/instagram_cookies.txt

# To'g'ri format quyidagicha bo'lishi kerak:
# .instagram.com	TRUE	/	FALSE	1735689600	sessionid	abc123...
```

### Cookie eskirgan

- Cookie fayllarini yangilang (yangi export qiling)
- Cookie'lar 1-2 haftadan keyin eskirishi mumkin

### Script ishlamayapti

```bash
# Script'ga permission bering
chmod +x SETUP_MULTIPLE_COOKIES.sh

# Qayta ishga tushiring
./SETUP_MULTIPLE_COOKIES.sh
```

---

## ‚úÖ Tugadi!

Endi bot bir nechta cookie fayllaridan foydalanadi va agar biri ishlamasa, ikkinchisini sinaydi.

**Muhim eslatmalar:**
- Cookie fayllarini muntazam yangilang (har hafta)
- Har bir cookie turli account'dan bo'lishi yaxshi
- Cookie fayllarini hech kimga bermang (xavfsizlik)
